---
title: 'Task 1: Agglomerative Hierarchical Clustering'
author: "Laurel Wee"
date: "3/6/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)

library(tidyverse)
library(here)
library(naniar)
library(NbClust)
```

```{r}
stream_chem <- read.csv(here("data","sbc_lter_registered_stream_chemistry - sbc_lter_registered_stream_chemistry.csv")) %>% 
  na_if(-999.0)%>% 
  select(site_code,nh4_uM,no3_uM,po4_uM)
```

```{r}
stream_avg <-stream_chem %>% 
  group_by(site_code) %>% 
  summarise_all(mean, na.rm=TRUE)

stream_scale <- stream_avg %>% 
  select(nh4_uM,no3_uM,po4_uM) %>% 
  scale()

rownames(stream_scale)<-stream_avg$site_code

```

```{r}
# Compute dissimilarity values (Euclidean distances):
euc_distance <- dist(stream_scale, method = "euclidean")

View(euc_distance)

# Hierarchical clustering (complete linkage)
hc_complete <- hclust(euc_distance, method = "complete" ) 

# Plot it (base plot):
plot(hc_complete, cex = 0.6, hang = -1)
```
```{r}

ggdendrogram(hc_complete,
             rotate = TRUE)+
  theme_minimal()+
  labs(x="Site")
  
```

